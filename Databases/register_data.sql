CREATE TABLE REGISTER(
ROLL_NUMBER BIGINT(10),
JOURNEY_DATE DATE NOT NULL,
JOURNEY_TIME TIME NOT NULL,
JOURNEY_PLACE_ID VARCHAR(5) NOT NULL,
NUMBER_PEOPLE INT(3) NOT NULL,
POOL_IN CHAR(1) NOT NULL,
ALLOCATION CHAR(1) DEFAULT 'N',
FOREIGN KEY (ROLL_NUMBER) REFERENCES STUDENT(ROLL_NUMBER)
);

CREATE TABLE FINAL(
ROLL_NUMBER VARCHAR(10),
JOURNEY_DATE DATE,
JOURNEY_PLACE_ID VARCHAR(5),
CAB_NUMBER VARCHAR(10),
POOL_IN CHAR(1),
NUMBER_PEOPLE INT(3),
PRIMARY KEY(ROLL_NUMBER)
);

INSERT INTO REGISTER VALUES ('1310110373','2015-04-24','08:20','PCGRN','1','Y','N');
INSERT INTO REGISTER VALUES ('1310110066','2015-04-24','08:20','PCGRN','1','N','N');
INSERT INTO REGISTER VALUES ('1310110241','2015-04-24','08:20','CONPL','1','Y','N');
INSERT INTO REGISTER VALUES ('1310110003','2015-04-24','08:20','CONPL','1','Y','N');
INSERT INTO REGISTER VALUES ('1310110002','2015-04-24','08:20','CONPL','1','N','N');
INSERT INTO REGISTER VALUES ('1310110002','2015-04-23','08:20','CONPL','1','N','N');


SELECT FINAL.ROLL_NUMBER,FINAL.JOURNEY_DATE,REGISTER.JOURNEY_TIME,FINAL.JOURNEY_PLACE_ID,FINAL.CAB_NUMBER,CAB.CAB_CARTYPE,FINAL.POOL_IN,FINAL.NUMBER_PEOPLE,CAB_RATE * PLACE_DISTANCE AS AMOUNT
FROM REGISTER,FINAL,CAB,PLACES
WHERE (REGISTER.ROLL_NUMBER = FINAL.ROLL_NUMBER AND CAB.CAB_NUMBER=FINAL.CAB_NUMBER AND PLACES.PLACE_ID=FINAL.JOURNEY_PLACE_ID)
ORDER BY FINAL.JOURNEY_DATE;
